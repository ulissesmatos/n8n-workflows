/**
 * n8n Node Icon Map
 * -----------------
 * Provides SVG icons for n8n workflow nodes.  Works in both browser (WordPress
 * plugin, vanilla JS) and as an ES module (Vue / Vite frontend).
 *
 * Usage (browser):
 *   <script src="n8n-node-icons.js"></script>
 *   N8nNodeIcons.getNodeIcon('n8n-nodes-base.openAi')
 *   N8nNodeIcons.extractNodes(workflowJson)
 *
 * Usage (ES module):
 *   import { getNodeIcon, extractNodes } from './n8n-node-icons.js';
 */
(function (root, factory) {
  if (typeof exports === 'object' && typeof module !== 'undefined') {
    module.exports = factory();
  } else if (typeof define === 'function' && define.amd) {
    define(factory);
  } else {
    root.N8nNodeIcons = factory();
  }
})(typeof globalThis !== 'undefined' ? globalThis : typeof self !== 'undefined' ? self : this, function () {
  'use strict';
/**
 * n8n Node Icon Map — ES Module version (for Vue / Vite frontend)
 * ----------------------------------------------------------------
 * import { getNodeIcon, extractNodes, renderBadges } from '@/utils/n8n-node-icons.js';
 */

  /* ================================================================
   * 1.  SVG ICON DEFINITIONS
   * ================================================================
   * Each entry: { svg, color, label }
   *  - svg   : raw SVG markup (24×24 viewBox)
   *  - color : hex brand / accent color
   *  - label : human-readable short name
   * ============================================================== */

  // Helper to wrap a Simple-Icons-style path in a standard 24×24 SVG
  function si(path, color) {
    return '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="' + color + '"><path d="' + path + '"/></svg>';
  }

  // Helper for custom icons using full SVG (stroke-based, 24×24)
  function custom(inner, color) {
    return '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="' + color + '" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' + inner + '</svg>';
  }

  // ---- Brand / Platform SVG paths (from Simple Icons, 24x24 viewBox) ----

  var BRANDS = {
    // Google
    google: { path: 'M12.48 10.92v3.28h7.84c-.24 1.84-.853 3.187-1.787 4.133-1.147 1.147-2.933 2.4-6.053 2.4-4.827 0-8.6-3.893-8.6-8.72s3.773-8.72 8.6-8.72c2.6 0 4.507 1.027 5.907 2.347l2.307-2.307C18.747 1.44 16.133 0 12.48 0 5.867 0 .307 5.387.307 12s5.56 12 12.173 12c3.573 0 6.267-1.173 8.373-3.36 2.16-2.16 2.84-5.213 2.84-7.667 0-.76-.053-1.467-.173-2.053H12.48z', color: '#4285F4' },
    // Google Sheets
    googleSheets: { path: 'M11.318 12.545H7.91v-1.909h3.41v1.91zm4.77 0h-3.408v-1.909h3.41v1.91zm-4.77 3.273H7.91v-1.91h3.41v1.91zm4.77 0h-3.408v-1.91h3.41v1.91zm1.134-11.59H6.778L3.545 8.182v13.09h16.91V4.228zM5.456 8.727l1.59-3.727h.046v3.727H5.456zm13.09 11.455H5.455V10.636h3.546V4.636h9.546v15.546z', color: '#0F9D58' },
    // Google Drive
    googleDrive: { path: 'M7.71 3.5L1.15 15l3.44 5.96 6.56-11.46L7.71 3.5zm1.94 0l6.56 11.46H22.85L16.29 3.5H9.65zm6.81 12.54l-3.43 5.96H19.56l3.44-5.96h-6.54z', color: '#4285F4' },
    // Google Calendar
    googleCalendar: { path: 'M18.316 5.684H24v12.632h-5.684V5.684zM5.684 24h12.632v-5.684H5.684V24zM18.316 5.684V0H5.684v5.684h12.632zM5.684 18.316H0V5.684h5.684v12.632zM7.987 14.469l.76-1.146c.418.356.903.587 1.465.587.665 0 1.09-.38 1.09-.97 0-.607-.463-.988-1.158-.988h-.627v-1.195h.57c.587 0 1-.33 1-.887 0-.522-.38-.872-.98-.872-.502 0-.93.2-1.312.521l-.684-1.116c.57-.487 1.285-.755 2.1-.755 1.437 0 2.379.753 2.379 1.943 0 .81-.503 1.378-1.196 1.6v.044c.76.16 1.35.795 1.35 1.68 0 1.312-1.08 2.194-2.58 2.194-.98 0-1.82-.368-2.177-.64zm6.43-4.63v5.09h-1.39V11.3l-1.235.855-.607-1.077 2.06-1.438h1.17z', color: '#4285F4' },
    // Gmail
    gmail: { path: 'M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z', color: '#EA4335' },
    // OpenAI / ChatGPT
    openai: { path: 'M22.282 9.821a5.985 5.985 0 0 0-.516-4.91 6.046 6.046 0 0 0-6.51-2.9A6.065 6.065 0 0 0 4.981 4.18a5.985 5.985 0 0 0-3.998 2.9 6.046 6.046 0 0 0 .743 7.097 5.98 5.98 0 0 0 .51 4.911 6.051 6.051 0 0 0 6.515 2.9A5.985 5.985 0 0 0 13.26 24a6.056 6.056 0 0 0 5.772-4.206 5.99 5.99 0 0 0 3.997-2.9 6.056 6.056 0 0 0-.747-7.073zM13.26 22.43a4.476 4.476 0 0 1-2.876-1.04l.141-.081 4.779-2.758a.795.795 0 0 0 .392-.681v-6.737l2.02 1.168a.071.071 0 0 1 .038.052v5.583a4.504 4.504 0 0 1-4.494 4.494zM3.6 18.304a4.47 4.47 0 0 1-.535-3.014l.142.085 4.783 2.759a.771.771 0 0 0 .78 0l5.843-3.369v2.332a.08.08 0 0 1-.033.062L9.74 19.95a4.5 4.5 0 0 1-6.14-1.646zM2.34 7.896a4.485 4.485 0 0 1 2.366-1.973V11.6a.766.766 0 0 0 .388.676l5.815 3.355-2.02 1.168a.076.076 0 0 1-.071 0l-4.83-2.786A4.504 4.504 0 0 1 2.34 7.872zm16.597 3.855l-5.833-3.387L15.119 7.2a.076.076 0 0 1 .071 0l4.83 2.791a4.494 4.494 0 0 1-.676 8.105v-5.678a.79.79 0 0 0-.407-.667zm2.01-3.023l-.141-.085-4.774-2.782a.776.776 0 0 0-.785 0L9.409 9.23V6.897a.066.066 0 0 1 .028-.061l4.83-2.787a4.5 4.5 0 0 1 6.68 4.66zm-12.64 4.135l-2.02-1.164a.08.08 0 0 1-.038-.057V6.075a4.5 4.5 0 0 1 7.375-3.453l-.142.08L8.704 5.46a.795.795 0 0 0-.393.681zm1.097-2.365l2.602-1.5 2.607 1.5v2.999l-2.597 1.5-2.607-1.5z', color: '#412991' },
    // Discord
    discord: { path: 'M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189z', color: '#5865F2' },
    // Slack
    slack: { path: 'M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52zM6.313 15.165a2.527 2.527 0 0 1 2.521-2.52 2.527 2.527 0 0 1 2.521 2.52v6.313A2.528 2.528 0 0 1 8.834 24a2.528 2.528 0 0 1-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528 0 0 1-2.521-2.52A2.528 2.528 0 0 1 8.834 0a2.528 2.528 0 0 1 2.521 2.522v2.52H8.834zM8.834 6.313a2.528 2.528 0 0 1 2.521 2.521 2.528 2.528 0 0 1-2.521 2.521H2.522A2.528 2.528 0 0 1 0 8.834a2.528 2.528 0 0 1 2.522-2.521h6.312zM18.956 8.834a2.528 2.528 0 0 1 2.522-2.521A2.528 2.528 0 0 1 24 8.834a2.528 2.528 0 0 1-2.522 2.521h-2.522V8.834zM17.688 8.834a2.528 2.528 0 0 1-2.523 2.521 2.527 2.527 0 0 1-2.52-2.521V2.522A2.527 2.527 0 0 1 15.165 0a2.528 2.528 0 0 1 2.523 2.522v6.312zM15.165 18.956a2.528 2.528 0 0 1 2.523 2.522A2.528 2.528 0 0 1 15.165 24a2.527 2.527 0 0 1-2.52-2.522v-2.522h2.52zM15.165 17.688a2.527 2.527 0 0 1-2.52-2.523 2.526 2.526 0 0 1 2.52-2.52h6.313A2.527 2.527 0 0 1 24 15.165a2.528 2.528 0 0 1-2.522 2.523h-6.313z', color: '#4A154B' },
    // Telegram
    telegram: { path: 'M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z', color: '#26A5E4' },
    // GitHub
    github: { path: 'M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12', color: '#181717' },
    // Microsoft / Azure
    microsoft: { path: 'M0 0h11.377v11.372H0zm12.623 0H24v11.372H12.623zM0 12.623h11.377V24H0zm12.623 0H24V24H12.623', color: '#5E5E5E' },
    // Notion
    notion: { path: 'M4.459 4.208c.746.606 1.026.56 2.428.466l13.215-.793c.28 0 .047-.28-.046-.326L17.86 1.968c-.42-.326-.98-.7-2.055-.607L2.58 2.514c-.467.047-.56.28-.374.466zm.793 3.08v13.904c0 .747.373 1.027 1.214.98l14.523-.84c.841-.046.935-.56.935-1.166V6.354c0-.606-.233-.933-.748-.886l-15.177.887c-.56.047-.747.327-.747.933zm14.337.745c.093.42 0 .84-.42.888l-.7.14v10.264c-.608.327-1.168.514-1.635.514-.748 0-.935-.234-1.495-.933l-4.577-7.186v6.952l1.448.327s0 .84-1.168.84l-3.222.186c-.093-.186 0-.653.327-.746l.84-.233V9.854L7.822 9.76c-.094-.42.14-1.026.793-1.073l3.456-.233 4.764 7.279v-6.44l-1.215-.14c-.093-.514.28-.886.747-.933zM1.936 1.035l13.31-.98c1.634-.14 2.055-.047 3.082.7l4.249 2.986c.7.513.934.653.934 1.213v16.378c0 1.026-.373 1.634-1.68 1.726l-15.458.934c-.98.047-1.448-.093-1.962-.747l-3.129-4.06c-.56-.747-.793-1.306-.793-1.96V2.667c0-.839.374-1.54 1.447-1.632z', color: '#000000' },
    // Airtable
    airtable: { path: 'M11.553 1.106L2.14 5.142c-.529.227-.526.969.006 1.191l9.466 3.895a1.67 1.67 0 0 0 1.274-.003l9.378-3.89c.533-.221.536-.964.006-1.19L12.84 1.109a1.67 1.67 0 0 0-1.287-.003zM12.7 13.263v9.382a.575.575 0 0 0 .796.532l10.14-4.263a.575.575 0 0 0 .355-.531V9.02a.575.575 0 0 0-.799-.531l-10.14 4.243a.575.575 0 0 0-.352.531zm-1.834-.45L1.2 8.813a.575.575 0 0 0-.84.508v9.206c0 .222.128.424.328.519l9.665 4.567a.575.575 0 0 0 .838-.512V13.34a.575.575 0 0 0-.325-.527z', color: '#18BFFF' },
    // Stripe
    stripe: { path: 'M13.976 9.15c-2.172-.806-3.356-1.426-3.356-2.409 0-.831.683-1.305 1.901-1.305 2.227 0 4.515.858 6.09 1.631l.89-5.494C18.252.975 15.697 0 12.165 0 9.667 0 7.589.654 6.104 1.872 4.56 3.147 3.757 4.992 3.757 7.218c0 4.039 2.467 5.76 6.476 7.219 2.585.92 3.445 1.574 3.445 2.583 0 .98-.84 1.545-2.354 1.545-1.875 0-4.965-.921-7.076-2.19l-.893 5.575C4.746 22.897 7.792 24 11.553 24c2.6 0 4.717-.636 6.23-1.834 1.654-1.3 2.49-3.218 2.49-5.602 0-4.128-2.508-5.82-6.297-7.414', color: '#635BFF' },
    // Twilio
    twilio: { path: 'M12 0C5.381 0 0 5.381 0 12s5.381 12 12 12 12-5.381 12-12S18.619 0 12 0zm0 20.16c-4.5 0-8.16-3.66-8.16-8.16S7.5 3.84 12 3.84s8.16 3.66 8.16 8.16-3.66 8.16-8.16 8.16zm3.12-11.28c0 1.023-.832 1.856-1.856 1.856s-1.856-.832-1.856-1.856.832-1.856 1.856-1.856 1.856.833 1.856 1.856zm0 6.24c0 1.023-.832 1.856-1.856 1.856s-1.856-.832-1.856-1.856.832-1.856 1.856-1.856 1.856.833 1.856 1.856zm-6.24 0c0 1.023-.832 1.856-1.856 1.856S5.168 16.143 5.168 15.12s.832-1.856 1.856-1.856 1.856.833 1.856 1.856zm0-6.24c0 1.023-.832 1.856-1.856 1.856S5.168 9.903 5.168 8.88s.832-1.856 1.856-1.856 1.856.833 1.856 1.856z', color: '#F22F46' },
    // Shopify
    shopify: { path: 'M15.337 23.979l7.216-1.561s-2.604-17.613-2.625-17.73c-.018-.116-.114-.192-.211-.192s-1.929-.136-1.929-.136-1.275-1.274-1.439-1.411c-.045-.037-.075-.057-.121-.074l-.914 21.104h.023zM11.71 11.305s-.81-.424-1.774-.424c-1.447 0-1.504.906-1.504 1.141 0 1.232 3.24 1.715 3.24 4.609 0 2.274-1.447 3.741-3.397 3.741-2.344 0-3.527-1.447-3.527-1.447l.631-2.073s1.27 1.08 2.33 1.08c.697 0 .992-.547.992-.952 0-1.627-2.654-1.694-2.654-4.357 0-2.24 1.615-4.42 4.867-4.42 1.249 0 1.869.36 1.869.36l-.735 2.344-.338.398zm-.5-9.74c.154 0 .31.038.463.135.598.38 1.693 1.91 2.06 3.307-1.166.358-2.447.75-3.728 1.143.72-2.729 1.934-4.5 3.206-4.585z', color: '#7AB55C' },
    // WordPress
    wordpress: { path: 'M21.469 6.825c.84 1.537 1.318 3.3 1.318 5.175 0 3.979-2.156 7.456-5.363 9.325l3.295-9.527c.615-1.54.82-2.771.82-3.864 0-.405-.027-.78-.07-1.109m-7.981.105c.647-.034 1.233-.1 1.233-.1.58-.068.512-.921-.068-.889 0 0-1.744.138-2.87.138-1.058 0-2.835-.138-2.835-.138-.58-.032-.648.855-.068.889 0 0 .552.066 1.13.1l1.68 4.605-2.36 7.08-3.927-11.685c.647-.034 1.233-.1 1.233-.1.58-.068.512-.921-.068-.889 0 0-1.744.138-2.87.138-.2 0-.44-.005-.693-.014C4.758 3.073 8.092 1.2 11.854 1.2c2.8 0 5.353 1.07 7.271 2.823-.047-.003-.09-.009-.141-.009-1.058 0-1.81.921-1.81 1.91 0 .889.513 1.637 1.058 2.525.41.72.889 1.644.889 2.977 0 .921-.354 1.988-.82 3.477l-1.075 3.591-3.893-11.58-.001.002zm-3.342 1.241l4.615 12.615L10.686 20c-.24-.085-.48-.163-.72-.235-.24-.073-.48-.135-.72-.187L14.146 8.17zm-4.894-.037c-.082-.025-.163-.047-.246-.066L5 17.789l3.3-9.588-.047-.067z', color: '#21759B' },
    // Jira
    jira: { path: 'M11.571 11.513H0a5.218 5.218 0 0 0 5.232 5.215h2.13v2.057A5.215 5.215 0 0 0 12.575 24V12.518a1.005 1.005 0 0 0-1.005-1.005zm5.723-5.756H5.736a5.215 5.215 0 0 0 5.215 5.214h2.129v2.058a5.218 5.218 0 0 0 5.215 5.214V6.758a1.001 1.001 0 0 0-1.001-1.001zM23.013 0H11.455a5.215 5.215 0 0 0 5.215 5.215h2.129v2.057A5.215 5.215 0 0 0 24.013 12.487V1.005A1.005 1.005 0 0 0 23.013 0z', color: '#0052CC' },
    // Trello
    trello: { path: 'M21 0H3C1.343 0 0 1.343 0 3v18c0 1.656 1.343 3 3 3h18c1.656 0 3-1.344 3-3V3c0-1.657-1.344-3-3-3zM10.44 18.18c0 .795-.645 1.44-1.44 1.44H4.56c-.795 0-1.44-.646-1.44-1.44V4.56c0-.795.645-1.44 1.44-1.44H9c.795 0 1.44.645 1.44 1.44v13.62zm10.44-6c0 .794-.645 1.44-1.44 1.44H15c-.795 0-1.44-.646-1.44-1.44V4.56c0-.795.645-1.44 1.44-1.44h4.44c.795 0 1.44.645 1.44 1.44v7.62z', color: '#0052CC' },
    // Asana
    asana: { path: 'M19.379 9.108c-2.603 0-4.714 2.11-4.714 4.713 0 2.602 2.11 4.713 4.714 4.713C21.98 18.534 24 16.423 24 13.821c0-2.603-2.02-4.713-4.621-4.713zm-14.758 0c-2.603 0-4.621 2.11-4.621 4.713 0 2.602 2.018 4.713 4.621 4.713 2.603 0 4.714-2.11 4.714-4.713 0-2.603-2.11-4.713-4.714-4.713zM16.714 5.466c0-2.603-2.11-4.714-4.714-4.714-2.603 0-4.714 2.111-4.714 4.714 0 2.603 2.11 4.714 4.714 4.714 2.603-.001 4.714-2.112 4.714-4.714z', color: '#F06A6A' },
    // Dropbox
    dropbox: { path: 'M12 6.13L6 9.926l6 3.795-6 3.796L0 13.721l6-3.795L0 6.13 6 2.334l6 3.796zm-.09 14.242l-5.91-3.71-5.91 3.71L6 24.092l5.91-3.72zM0 17.317l6 3.795 6-3.795-6-3.796-6 3.796zm12.09-3.396l5.91-3.71-5.91-3.796L18 2.619l6 3.796-6 3.795 6 3.796-6 3.795-5.91-3.68zm.06 6.21l5.91-3.71L24 20.218l-5.94 3.72-5.91-3.808z', color: '#0061FF' },
    // AWS
    aws: { path: 'M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 0 1-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 0 1-.287-.375 6.18 6.18 0 0 1-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.032-.863.104-.296.072-.583.16-.863.272a2.29 2.29 0 0 1-.28.104.488.488 0 0 1-.127.024c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 0 1 .224-.167c.28-.144.616-.264 1.01-.36a4.89 4.89 0 0 1 1.246-.152c.95 0 1.644.216 2.091.647.44.43.662 1.085.662 1.963v2.586zm-3.24 1.214c.263 0 .534-.048.822-.144.287-.096.543-.271.758-.51.128-.152.224-.32.272-.512.047-.191.08-.423.08-.694v-.335a6.66 6.66 0 0 0-.735-.136 6.02 6.02 0 0 0-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.917 0 .375.095.655.295.846.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 0 1-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.025.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 0 1 .32-.08h.638c.152 0 .256.025.32.08.063.048.12.16.151.312l1.261 5.348 1.381-5.348c.048-.16.104-.264.16-.312a.52.52 0 0 1 .311-.08h.743c.128 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 0 1-.056.2l-1.923 6.17c-.048.16-.104.264-.168.312a.517.517 0 0 1-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.918-.32-.128-.071-.216-.151-.248-.224a.555.555 0 0 1-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024s.12.056.2.096c.271.12.566.215.878.279.319.064.63.096.95.096.503 0 .894-.088 1.165-.264a.86.86 0 0 0 .415-.758.777.777 0 0 0-.215-.559c-.144-.151-.415-.287-.806-.415l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 0 1-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415a3.58 3.58 0 0 1 1.005-.136c.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 0 1 .24.2.43.43 0 0 1 .071.263v.375c0 .168-.064.256-.184.256a.83.83 0 0 1-.303-.096 3.652 3.652 0 0 0-1.532-.311c-.455 0-.815.072-1.062.223-.248.152-.375.383-.375.694 0 .223.08.415.24.567.159.152.454.304.87.44l1.133.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926-.143.272-.335.511-.583.703-.248.2-.543.343-.894.44-.36.104-.743.16-1.15.16z', color: '#232F3E' },
    // Supabase
    supabase: { path: 'M21.362 9.354H12V.396a.396.396 0 0 0-.716-.233L2.203 12.424l-.401.562a1.04 1.04 0 0 0 .836 1.66H12v8.957a.396.396 0 0 0 .716.233l9.081-12.261.401-.562a1.04 1.04 0 0 0-.836-1.66z', color: '#3ECF8E' },
    // Firebase
    firebase: { path: 'M3.89 15.672L6.255.461A.542.542 0 0 1 7.27.288l2.543 4.771zm16.794 3.692l-2.25-14a.54.54 0 0 0-.919-.295L3.316 19.365l7.856 4.427a1.621 1.621 0 0 0 1.588 0zM14.3 7.147l-1.82-3.482a.542.542 0 0 0-.96 0L3.53 17.984z', color: '#FFCA28' },
    // MongoDB
    mongodb: { path: 'M17.193 9.555c-1.264-5.58-4.252-7.414-4.573-8.115-.28-.394-.53-.954-.735-1.44-.036.495-.055.685-.523 1.184-.723.566-4.438 3.682-4.74 10.02-.282 5.912 4.27 9.435 4.888 9.884l.07.05A73.49 73.49 0 0 1 11.91 24h.238c.083-.396.161-.813.26-1.246.642-.09.861-.48.973-.9 0 0-1.295-.76-1.333-4.125-.04-3.556 2.568-6.143 5.145-8.174z', color: '#47A248' },
    // MySQL
    mysql: { path: 'M16.405 5.501c-.115 0-.193.014-.274.033v.013h.014c.054.104.146.18.214.273.054.107.1.214.154.32l.014-.015c.094-.066.14-.172.14-.333-.04-.047-.046-.094-.08-.14-.04-.067-.126-.1-.18-.153zM5.77 18.695h-.927a66.32 66.32 0 0 1-.454-3.545c-.014.476-.04.953-.054 1.43l-.36 2.116H3.03l-.547-4.287h.666l.313 2.7c.02-.418.04-.837.067-1.256l.393-1.444h.727l.32 1.444c.027.39.047.78.073 1.17l.32-2.614h.6L5.77 18.695zm2.14 0h-.767l-.393-2.387h.006c-.02.467-.053.934-.08 1.4l-.326 1.987h-.467L5.5 14.408h.587l.354 2.467.007.007c.014-.384.033-.768.053-1.152l.347-1.322h.66L7.91 18.695zm2.167 0H9.4v-4.287h.673v3.612h.773v.675h.23zm.54 0v-4.287h.666v4.287h-.666zm1.333 0v-4.287h.667v4.287h-.667zm.913-3.612v-.675h2.28v.675h-.773v3.612h-.667v-3.612h-.84z', color: '#4479A1' },
    // PostgreSQL
    postgresql: { path: 'M23.5594 14.7228a.5269.5269 0 0 0-.0437-.1753c-.5845-1.3596-1.1695-2.7165-1.7529-4.0719-.4601-.0332-1.836-.0518-2.2677-.0442-.4957.0088-.993.017-1.4898.0379-.1008-.006-.6763-.0109-.7785-.0109-1.0023.0044-2.0031.043-3.0044.052-.0752-.0002-2.0598-.0296-2.1361-.0296-.1654 0-.3317-.0018-.4974.003-1.6714.0497-3.3498-.0396-5.0187.0559-.7267.0415-1.457.0256-2.1837.0661a.0412.0412 0 0 0-.039.033 97.91 97.91 0 0 1-.474-1.1019A.0412.0412 0 0 0 4.25 9.485c-.7087-.0003-2.3468-.0003-2.3468-.0003l.0004.039c.6495 1.5063 1.297 3.0137 1.9469 4.519.0087.0177.0259.0284.044.0284.6074-.0066 1.2148-.0228 1.8222-.0337l.2107-.0015c.0028-.0004.0132.0005.0172-.0016.0056-.003.0043-.0103.0062-.0158.2282-.6269.457-1.2534.685-1.8803 1.2043-.012 2.4113-.0068 3.6168-.004 1.1775.003 2.3547.0108 3.532.0203.0066.0003.0131 0 .0166.006.006.0056.0034.0145.0047.0218.0882.3803.1774.7604.2637 1.1411.001.0027.0009.0065-.0004.009-.0013.004-.0032.0046-.0214.0046-.4424.0052-.8845.016-1.3268.025-.4432.0092-.886.019-1.329.029-.4494.0096-.8987.0192-1.348.02-.466-.0008-.9319-.004-1.398.003-.42.006-.8416-.0062-1.2616.003-.4348.0094-.8722.0037-1.307.0093-.4346.0054-.8691.001-1.3037.0058-.0103.0001-.0206-.001-.0306.003-.0056.0023-.003.0103-.0044.0151-.1544.4206-.3077.842-.4618 1.2626a.0345.0345 0 0 1-.0326.0233c-.6074.0107-1.215.0271-1.8224.0337a.044.044 0 0 1-.044-.0284c-.6499-1.5054-1.2974-3.0127-1.9469-4.519l-.0004-.039s1.6382 0 2.3468.0004a.0413.0413 0 0 1 .0385.027c.1572.366.3152.7316.474 1.102.0075.0174.023.0286.0393.033 1.6689-.0955 3.3468-.0064 5.0187-.0559.166-.005.3321-.003.4975-.003.0763 0 2.0609.0294 2.1361.0296 1.0013-.009 2.0021-.0476 3.0044-.052.1022 0 .6777.005.7785.011.4969-.021.9941-.0292 1.4898-.038.4317-.0076 1.8076.011 2.2677.044.5834 1.3554 1.1684 2.7123 1.7529 4.072a.5282.5282 0 0 0 .0437.1753c.0081.0094.0208.0126.0333.0126.8497-.0063 1.6995-.0118 2.5492-.016a.0352.0352 0 0 0 .0337-.0244c-.6519-1.5067-1.303-3.0157-1.9516-4.5254a.0367.0367 0 0 0-.0343-.0227c-.8485-.0043-2.5486-.0098-2.5486-.0098z', color: '#4169E1' },
    // Redis
    redis: { path: 'M23.99 14.34c-.01.87-1.47 1.65-4.6 2.53-3.13.88-7.26 1.37-11.63 1.37-4.38 0-8.5-.49-11.63-1.37C1.34 15.67.01 14.83 0 13.87v2.6c.01.87 1.34 1.7 4.14 2.5 3.13.88 7.26 1.37 11.63 1.37 4.37 0 8.5-.49 11.63-1.37 2.79-.8 4.13-1.63 4.14-2.5zM0 10.54v2.6c.01.87 1.34 1.7 4.14 2.5 3.13.88 7.26 1.37 11.63 1.37 4.37 0 8.5-.49 11.63-1.37 2.79-.8 4.13-1.63 4.14-2.5v-2.6c-.01.87-1.35 1.7-4.14 2.5-3.13.87-7.26 1.36-11.63 1.36-4.38 0-8.5-.49-11.63-1.37C1.34 12.24.01 11.41 0 10.54zm0-3.42v2.6c.01.87 1.34 1.7 4.14 2.5 3.13.88 7.26 1.37 11.63 1.37 4.37 0 8.5-.49 11.63-1.37 2.79-.8 4.13-1.64 4.14-2.5V7.12c-.01.87-1.35 1.7-4.14 2.5-3.13.87-7.26 1.36-11.63 1.36-4.38 0-8.5-.49-11.63-1.37C1.34 8.82.01 7.99 0 7.12zm23.99.12c-.01-.87-1.35-1.7-4.14-2.5C16.72 3.86 12.6 3.37 8.23 3.37c-4.38 0-8.5.49-11.63 1.37C1.34 5.54.01 6.37 0 7.24c.01.87 1.34 1.7 4.14 2.5 3.13.88 7.26 1.37 11.63 1.37 4.37 0 8.5-.49 11.63-1.37 2.79-.8 4.13-1.64 4.14-2.5z', color: '#DC382D' },
    // Salesforce
    salesforce: { path: 'M10.006 5.17a4.648 4.648 0 0 1 3.408-1.488 4.64 4.64 0 0 1 4.181 2.63 5.601 5.601 0 0 1 2.38-.531 5.6 5.6 0 0 1 5.6 5.6 5.6 5.6 0 0 1-5.6 5.6c-.478 0-.94-.061-1.382-.174a4.156 4.156 0 0 1-3.7 2.267c-.6 0-1.17-.127-1.684-.356a5.12 5.12 0 0 1-4.67 3.011c-2.46 0-4.52-1.733-5.013-4.045A4.14 4.14 0 0 1 0 13.69a4.14 4.14 0 0 1 3.678-4.11 5.19 5.19 0 0 1-.152-1.224 5.2 5.2 0 0 1 5.2-5.2 5.18 5.18 0 0 1 1.28.162z', color: '#00A1E0' },
    // HubSpot
    hubspot: { path: 'M18.164 7.93V4.86a2.588 2.588 0 0 0 1.497-2.335C19.661 1.131 18.529 0 17.133 0a2.533 2.533 0 0 0-2.531 2.527c0 1.063.66 1.972 1.59 2.345v3.05a6.08 6.08 0 0 0-2.894 1.378L6.037 3.756a2.026 2.026 0 0 0 .054-.456A2.04 2.04 0 0 0 4.045 1.26 2.043 2.043 0 0 0 2 3.306c0 .815.48 1.516 1.17 1.845l-.056 6.564a3.82 3.82 0 0 0-1.998 3.355c0 1.995 1.528 3.637 3.48 3.826l1.602 2.54a2.06 2.06 0 0 0-.326 1.118A2.06 2.06 0 0 0 7.93 24.61c1.138 0 2.06-.921 2.06-2.056 0-.434-.137-.836-.37-1.168l1.525-2.42a6.1 6.1 0 0 0 1.987.336 6.12 6.12 0 0 0 6.12-6.12c0-2.79-1.867-5.14-4.42-5.882l-.668-.37z', color: '#FF7A59' },
    // Mailchimp
    mailchimp: { path: 'M18.384 22.779a1.19 1.19 0 0 1-1.107.145c-.742-.3-1.045-.939-1.116-1.727-.07-.787.154-1.537.308-2.107.064-.238.088-.38.105-.457-.605.526-1.27.741-2.068.741-1.072 0-1.918-.482-2.452-1.345-.188-.303-.325-.639-.413-1.005-.23.198-.46.381-.693.548-.844.604-1.739.96-2.663.96C7.3 18.53 6.576 18.131 6 17.455c-.587-.688-.887-1.593-.887-2.689 0-1.463.515-3.071 1.431-4.536-1.273.068-2.238-.17-2.875-.781-.58-.555-.825-1.326-.71-2.295.198-1.668 1.476-3.5 2.82-4.53 1.14-.874 2.375-1.33 3.406-1.33 1.05 0 1.787.555 2.03 1.492.156.604.138 1.287-.099 2.089l-.024.069c-.252.774-.672 1.65-1.203 2.465l-.153.22c-.038-.01-.076-.018-.112-.024-.265-.044-.565-.003-.838.153-.297.17-.49.446-.531.79-.041.345.09.72.296.883l.082.052c.228.133.498.13.77.005l.054-.029.037-.019c.03-.018.066-.042.103-.072l.107-.147c.065-.09.14-.198.225-.325a1.69 1.69 0 0 0-.018-1.776c-.234-.423-.602-.69-1.005-.755-.295-.047-.592.01-.862.183l-.134.105c.478-.74.864-1.534 1.095-2.24.207-.671.226-1.205.104-1.678-.151-.584-.594-.877-1.3-.877-.825 0-1.869.371-2.874 1.142-1.226.94-2.386 2.597-2.564 4.083-.082.688.073 1.197.458 1.565.44.42 1.127.573 1.997.533l.138-.009c-.78 1.368-1.213 2.874-1.213 4.166 0 .855.219 1.537.652 2.044.426.5.985.734 1.583.734.704 0 1.39-.27 2.04-.713.383-.261.756-.587 1.124-.97.097 1.033.566 1.768 1.383 2.127.516.227 1.14.283 1.785.159.613-.117 1.22-.395 1.793-.812.174-.126.35-.268.524-.423.124.69.41 1.28.869 1.65.434.35.97.447 1.546.253a2.263 2.263 0 0 0 .442-.217l.063-.042.037-.082a.145.145 0 0 0-.056-.168z', color: '#FFE01B' },
    // SendGrid / Twilio SendGrid
    sendgrid: { path: 'M15.994 0L8 4v4l-4 2.33V14l7.994 4.67L16 16.33v-4l4-2.33V6.33L15.994 0zm0 3.89L19 6v2.33L15.994 12 13 10.33V6l2.994-2.11zM4 10.33L7 12v3.67L4 14V10.33zm3.994 8L4.89 16.33l3.104-2V16l3.006 1.33v2.33l-3-1.33z', color: '#51A9E3' },
    // Zendesk
    zendesk: { path: 'M11.087 6.987V24L0 6.987h11.087zM11.087 0C11.087 3.062 8.15 5.543 4.544 5.543S-2 3.062-2 0h13.087zm1.826 24c0-3.062 2.937-5.543 6.544-5.543C22.863 18.457 26 20.938 26 24H12.913zm0-6.987V0L24 17.013H12.913z', color: '#03363D' },
    // Intercom
    intercom: { path: 'M20.77 7.27v8.32c0 .44-.36.8-.8.8s-.8-.36-.8-.8V7.27c0-.44.36-.8.8-.8s.8.36.8.8zm-3.66-1.26v11.14c0 .44-.36.8-.8.8s-.8-.36-.8-.8V6.01c0-.44.36-.8.8-.8s.8.36.8.8zm-3.63-.82v12.47c0 .44-.36.8-.8.8s-.8-.36-.8-.8V5.19c0-.44.36-.8.8-.8s.8.36.8.8zm-3.66.82v11.14c0 .44-.36.8-.8.8s-.8-.36-.8-.8V6.01c0-.44.36-.8.8-.8s.8.36.8.8zm-3.63 1.26v8.32c0 .44-.36.8-.8.8s-.8-.36-.8-.8V7.27c0-.44.36-.8.8-.8s.8.36.8.8zM21.4 19.46c-.1-.06-2.39-1.52-9.4-1.52-7.01 0-9.3 1.46-9.4 1.52a.788.788 0 0 0-.3.63c0 .44.36.8.8.8.14 0 .28-.04.4-.11.01-.01 2.14-1.32 8.5-1.32 6.37 0 8.49 1.31 8.5 1.32.12.07.26.11.4.11.44 0 .8-.36.8-.8a.788.788 0 0 0-.3-.63zM24 2.76v18.48A2.76 2.76 0 0 1 21.24 24H2.76A2.76 2.76 0 0 1 0 21.24V2.76A2.76 2.76 0 0 1 2.76 0h18.48A2.76 2.76 0 0 1 24 2.76z', color: '#6AFDEF' },
    // Webflow
    webflow: { path: 'M24 4.515v14.97c0 2.495-2.023 4.515-4.515 4.515H4.515C2.023 24 0 21.977 0 19.485V4.515C0 2.023 2.023 0 4.515 0h14.97C21.977 0 24 2.023 24 4.515zM17.76 11.1c-.04.08-.09.24-.16.38l-2.14 4.72-2.34-7.52H9.78s2.68 7.2 2.78 7.46c.02.04.04.1.04.16 0 .06-.04.08-.08.08l-2.7.02c.04.08.08.24.08.38a.41.41 0 0 1-.02.16l-.38 1.04-.04.1c0 .04.02.06.06.06h3.54l.58 1.52c.04.12.08.24.08.36 0 .12-.06.16-.14.18.02.04.06.1.06.18 0 .1-.04.2-.1.32l-.38.88c-.04.08-.04.16 0 .22.02.04.06.06.12.06h2.1l4.3-11.84c.06-.18.06-.36-.02-.5a.42.42 0 0 0-.36-.2h-1.38c-.18 0-.34.08-.4.32z', color: '#4353FF' },
    // Figma
    figma: { path: 'M15.852 8.981h-4.588V0h4.588c2.476 0 4.49 2.014 4.49 4.49s-2.014 4.491-4.49 4.491zM12.735 7.51h3.117c1.665 0 3.019-1.355 3.019-3.019s-1.355-3.019-3.019-3.019h-3.117V7.51zm0 8.943h-4.588c-2.476 0-4.49-2.014-4.49-4.49s2.014-4.49 4.49-4.49h4.588v8.98zm-4.587-7.51c-1.665 0-3.019 1.355-3.019 3.019s1.355 3.019 3.019 3.019h3.116V8.943H8.148zm4.587 15.057h-4.588c-2.476 0-4.49-2.014-4.49-4.49s2.014-4.49 4.49-4.49h4.588v8.98zm-4.587-7.51c-1.665 0-3.019 1.355-3.019 3.019s1.355 3.019 3.019 3.019h3.116v-6.038H8.148zm0-1.472A4.495 4.495 0 0 1 3.657 12c0-2.476 2.014-4.49 4.49-4.49s4.49 2.014 4.49 4.49-2.013 4.49-4.49 4.49zm0-7.51c-1.665 0-3.019 1.355-3.019 3.019s1.355 3.019 3.019 3.019 3.019-1.355 3.019-3.019-1.355-3.019-3.019-3.019z', color: '#F24E1E' },
    // Twitter / X
    x: { path: 'M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z', color: '#000000' },
    // Facebook
    facebook: { path: 'M9.101 23.691v-7.98H6.627v-3.667h2.474v-1.58c0-4.085 1.848-5.978 5.858-5.978.401 0 1.09.059 1.373.118V8.01c-.326-.037-.89-.059-1.598-.059-2.268 0-3.148.857-3.148 3.085v1.013h4.504l-.775 3.665h-3.73v8.168C19.396 23.2 24 18.14 24 12.02 24 5.384 18.624 0 12 0S0 5.384 0 12.02c0 5.326 3.712 9.793 8.68 10.935.139.024.281.044.421.061z', color: '#0866FF' },
    // LinkedIn
    linkedin: { path: 'M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z', color: '#0A66C2' },
    // YouTube
    youtube: { path: 'M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z', color: '#FF0000' },
    // WhatsApp
    whatsapp: { path: 'M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 0 1-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 0 1-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 0 1 2.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0 0 12.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 0 0 5.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 0 0-3.48-8.413z', color: '#25D366' },
    // Zoom
    zoom: { path: 'M4.585 7.065a2.317 2.317 0 0 0-2.316 2.317v5.236a3.476 3.476 0 0 0 3.476 3.476h8.744a2.317 2.317 0 0 0 2.317-2.317V10.54a3.476 3.476 0 0 0-3.476-3.476zM18.271 9.14l3.455-2.47a.6.6 0 0 1 .949.487v9.688a.6.6 0 0 1-.949.487l-3.455-2.47z', color: '#0B5CFF' },
    // Spotify
    spotify: { path: 'M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z', color: '#1DB954' },
    // Anthropic / Claude
    anthropic: { path: 'M17.303 3.635h-3.48L20.637 20.37h3.48zm-10.49 0L0 20.37h3.48l1.374-3.632h7.084l1.374 3.632h3.48L10.053 3.635zm-.394 10.163 2.39-6.304 2.395 6.304z', color: '#D97757' },
    // Zapier
    zapier: { path: 'M15.553 8.448l3.453-3.464-1.99-1.99-3.464 3.454a7.98 7.98 0 0 0-3.104 0L6.984 2.994l-1.99 1.99 3.454 3.464a7.98 7.98 0 0 0-1.552 1.552L3.432 6.546l-1.99 1.99 3.454 3.464a7.98 7.98 0 0 0 0 3.104L1.442 18.568l1.99 1.99 3.464-3.454a7.98 7.98 0 0 0 1.552 1.552L4.994 22.12l1.99 1.99 3.464-3.454a7.98 7.98 0 0 0 3.104 0l3.464 3.454 1.99-1.99-3.454-3.464a7.98 7.98 0 0 0 1.552-1.552l3.464 3.454 1.99-1.99-3.454-3.464a7.98 7.98 0 0 0 0-3.104l3.454-3.464-1.99-1.99-3.464 3.454a7.98 7.98 0 0 0-1.552-1.552zM12 15.6a3.6 3.6 0 1 1 0-7.2 3.6 3.6 0 0 1 0 7.2z', color: '#FF4A00' },
    // n8n
    n8n: { path: 'M12.8 2.4a2.4 2.4 0 1 0 0 4.8 2.4 2.4 0 0 0 0-4.8ZM6.4 9.6a2.4 2.4 0 1 0 0 4.8 2.4 2.4 0 0 0 0-4.8Zm12.8 0a2.4 2.4 0 1 0 0 4.8 2.4 2.4 0 0 0 0-4.8ZM12.8 16.8a2.4 2.4 0 1 0 0 4.8 2.4 2.4 0 0 0 0-4.8Z', color: '#EA4B71' },
    // HTTP Request / Webhook
    webhook: { path: 'M10.09 2.96c-.34.56-.86.97-1.47 1.17L12 10.57l3.38-6.44c-.61-.2-1.13-.61-1.47-1.17L12 6.08l-1.91-3.12zM7.98 14.31l-6.44 3.38c.2.61.2 1.27 0 1.88l3.12 1.64 1.64-3.12c-.56-.34-.97-.86-1.17-1.47l2.85-2.31zM16.02 14.31l2.85 2.31c-.2.61-.2 1.27 0 1.88l3.12-1.64-1.64-3.12c-.56.34-1.17.54-1.88.54-.34 0-.67-.06-.98-.16l-1.47.19z', color: '#6E42C1' },
    // Postgres (alias)
    postgres: { path: 'M23.5594 14.7228a.5269.5269 0 0 0-.0437-.1753c-.5845-1.3596-1.1695-2.7165-1.7529-4.0719-.4601-.0332-1.836-.0518-2.2677-.0442-.4957.0088-.993.017-1.4898.0379-.1008-.006-.6763-.0109-.7785-.0109-1.0023.0044-2.0031.043-3.0044.052-.0752-.0002-2.0598-.0296-2.1361-.0296-.1654 0-.3317-.0018-.4974.003-1.6714.0497-3.3498-.0396-5.0187.0559-.7267.0415-1.457.0256-2.1837.0661a.0412.0412 0 0 0-.039.033 97.91 97.91 0 0 1-.474-1.1019A.0412.0412 0 0 0 4.25 9.485c-.7087-.0003-2.3468-.0003-2.3468-.0003l.0004.039c.6495 1.5063 1.297 3.0137 1.9469 4.519.0087.0177.0259.0284.044.0284.6074-.0066 1.2148-.0228 1.8222-.0337l.2107-.0015c.0028-.0004.0132.0005.0172-.0016.0056-.003.0043-.0103.0062-.0158.2282-.6269.457-1.2534.685-1.8803 1.2043-.012 2.4113-.0068 3.6168-.004 1.1775.003 2.3547.0108 3.532.0203.0066.0003.0131 0 .0166.006.006.0056.0034.0145.0047.0218.0882.3803.1774.7604.2637 1.1411.001.0027.0009.0065-.0004.009-.0013.004-.0032.0046-.0214.0046-.4424.0052-.8845.016-1.3268.025-.4432.0092-.886.019-1.329.029-.4494.0096-.8987.0192-1.348.02-.466-.0008-.9319-.004-1.398.003-.42.006-.8416-.0062-1.2616.003-.4348.0094-.8722.0037-1.307.0093-.4346.0054-.8691.001-1.3037.0058-.0103.0001-.0206-.001-.0306.003-.0056.0023-.003.0103-.0044.0151-.1544.4206-.3077.842-.4618 1.2626a.0345.0345 0 0 1-.0326.0233c-.6074.0107-1.215.0271-1.8224.0337a.044.044 0 0 1-.044-.0284c-.6499-1.5054-1.2974-3.0127-1.9469-4.519l-.0004-.039s1.6382 0 2.3468.0004a.0413.0413 0 0 1 .0385.027c.1572.366.3152.7316.474 1.102.0075.0174.023.0286.0393.033 1.6689-.0955 3.3468-.0064 5.0187-.0559.166-.005.3321-.003.4975-.003.0763 0 2.0609.0294 2.1361.0296 1.0013-.009 2.0021-.0476 3.0044-.052.1022 0 .6777.005.7785.011.4969-.021.9941-.0292 1.4898-.038.4317-.0076 1.8076.011 2.2677.044.5834 1.3554 1.1684 2.7123 1.7529 4.072a.5282.5282 0 0 0 .0437.1753c.0081.0094.0208.0126.0333.0126.8497-.0063 1.6995-.0118 2.5492-.016a.0352.0352 0 0 0 .0337-.0244c-.6519-1.5067-1.303-3.0157-1.9516-4.5254a.0367.0367 0 0 0-.0343-.0227c-.8485-.0043-2.5486-.0098-2.5486-.0098z', color: '#4169E1' },
    // Microsoft Excel
    excel: { path: 'M23.004 1.5H8.25a.75.75 0 0 0-.75.75v3.75H1.5a.75.75 0 0 0-.75.75v10.5a.75.75 0 0 0 .75.75h6v3.75c0 .416.334.75.75.75h14.754a.996.996 0 0 0 .996-.998V2.498a.996.996 0 0 0-.996-.998zM7.5 18H2.25V6.75H7.5V18zm0 3.75V18.75H9v3H7.5zm9.75-3H14.25v-1.5h3v1.5zm0-3H14.25V14.25h3v1.5zm0-3H14.25v-1.5h3v1.5zm0-3H14.25V8.25h3v1.5zM5.25 16.5H3v-1.5h2.25v1.5zm0-3H3v-1.5h2.25v1.5zm0-3H3v-1.5h2.25v1.5z', color: '#217346' },
    // Microsoft Outlook
    outlook: { path: 'M24 7.387v10.478c0 .23-.08.424-.238.576-.16.154-.352.23-.578.23h-8.19v-6.09l1.628 1.206c.07.047.156.07.258.07s.188-.023.258-.07L24 8.168v-.781zm-.238-1.158c.178 0 .33.064.457.19.127.127.191.28.193.453l-7.08 5.26L8.994 5.79h14.004c.237 0 .44.082.604.247.153.16.227.34.24.54L24 7.387H8.994zM7.326 5.297v14.573L0 17.93V6.89l7.326-1.594zm-2.82 10.2c.447-.574.67-1.322.67-2.243 0-.893-.204-1.62-.614-2.182-.408-.564-.97-.846-1.682-.846-.683 0-1.218.273-1.606.818-.386.543-.58 1.254-.58 2.13 0 .903.19 1.627.573 2.17.384.545.914.817 1.59.817.703 0 1.249-.22 1.65-.664z', color: '#0078D4' },
    // Wikipedia
    wikipedia: { path: 'M12.09 13.119c-.936 1.932-2.217 4.548-2.853 5.728-.616 1.074-1.127.931-1.532.029-1.406-3.321-4.293-9.144-5.651-12.409-.251-.601-.441-.987-.619-1.139-.181-.15-.554-.24-1.122-.271C.103 5.033 0 4.982 0 4.898v-.455l.052-.045c.924-.005 5.401 0 5.401 0l.051.045v.434c0 .119-.075.176-.225.176l-.564.031c-.485.029-.727.164-.727.436 0 .135.053.33.166.601 1.082 2.646 4.818 10.521 4.818 10.521l.136.046 2.411-4.81-.482-1.067-1.658-3.264s-.318-.654-.428-.872c-.728-1.443-.712-1.518-1.447-1.617-.207-.023-.313-.05-.313-.149v-.468l.06-.045h4.292l.113.037v.451c0 .105-.076.15-.227.15l-.308.047c-.792.061-.661.381-.136 1.422l1.582 3.252 1.758-3.504c.293-.64.233-.801.111-.947-.07-.084-.305-.22-.812-.24l-.201-.021c-.052 0-.098-.015-.145-.051-.045-.031-.067-.076-.067-.129v-.427l.061-.045c1.247-.008 4.043 0 4.043 0l.059.045v.436c0 .121-.059.178-.193.178-.646.03-.782.095-1.023.439-.12.186-.375.589-.646 1.039l-2.301 4.273-.065.135 2.792 5.712.17.048 4.396-10.438c.154-.422.129-.722-.064-.895-.197-.172-.346-.273-.857-.295l-.42-.016c-.061 0-.105-.014-.152-.045-.043-.029-.072-.075-.072-.119v-.436l.059-.045h4.961l.041.045v.437c0 .119-.074.18-.209.18-.648.03-1.127.18-1.443.421-.314.255-.557.616-.736 1.067 0 0-4.043 9.258-5.426 12.339-.525 1.007-1.053.917-1.503-.031-.571-1.171-1.773-3.786-2.646-5.71l.053-.036z', color: '#000000' },
    // OpenRouter
    openrouter: { path: 'M16.778 1.844v1.919q-.569-.026-1.138-.032-.708-.008-1.415.037c-1.93.126-4.023.728-6.149 2.237-2.911 2.066-2.731 1.95-4.14 2.75-.396.223-1.342.574-2.185.798-.841.225-1.753.333-1.751.333v4.229s.768.108 1.61.333c.842.224 1.789.575 2.185.799 1.41.798 1.228.683 4.14 2.75 2.126 1.509 4.22 2.11 6.148 2.236.88.058 1.716.041 2.555.005v1.918l7.222-4.168-7.222-4.17v2.176c-.86.038-1.611.065-2.278.021-1.364-.09-2.417-.357-3.979-1.465-2.244-1.593-2.866-2.027-3.68-2.508.889-.518 1.449-.906 3.822-2.59 1.56-1.109 2.614-1.377 3.978-1.466.667-.044 1.418-.017 2.278.02v2.176L24 6.014Z', color: '#6366F1' },
    // Pipedrive
    pipedrive: { path: 'M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z', color: '#017737' },
    // Typeform
    typeform: { path: 'M2.16 6h19.68v2.4H2.16V6zm2.4 5.28h14.88v2.4H4.56v-2.4zm3.6 5.28h7.68v2.4H8.16v-2.4z', color: '#262627' },
    // Mattermost
    mattermost: { path: 'M12.081 0C7.048-.04 2.413 3.315.904 8.06c-1.762 5.53 1.234 11.49 6.652 13.482 1.336.49 2.591.676 3.828.696.065.036.082.005.082.005h.004c3.636.04 6.741-1.688 8.748-4.334l.004-.006c1.614-2.14 2.447-4.76 2.447-7.511v-.006c-.042-5.77-4.809-10.388-10.588-10.386zm5.807 16.193c-1.701 2.258-4.395 3.677-7.283 3.677h-.018c-1.073-.017-2.182-.18-3.378-.619-4.634-1.707-7.182-6.816-5.669-11.568C2.892 3.72 6.883.791 11.241.63l.041-.002.022-.001c.258-.006.516-.003.773.007 5.118.198 9.193 4.41 9.192 9.755v.004c0 2.46-.723 4.85-2.181 6.8z', color: '#0058CC' },
  };

  // ---- n8n Internal / Utility Node custom SVGs ----

  var N8N_INTERNAL = {
    // Code
    code: { svg: custom('<polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>', '#607D8B'), color: '#607D8B', label: 'Code' },
    // Set / Edit Fields
    set: { svg: custom('<path d="M12 20h9"/><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"/>', '#FF6D5A'), color: '#FF6D5A', label: 'Edit Fields' },
    editFields: { svg: custom('<path d="M12 20h9"/><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"/>', '#FF6D5A'), color: '#FF6D5A', label: 'Edit Fields' },
    // IF
    if: { svg: custom('<path d="M16 3h5v5"/><path d="M8 3H3v5"/><line x1="12" y1="22" x2="12" y2="12"/><path d="m21 3-9 9"/><path d="M3 3l9 9"/>', '#F4A261'), color: '#F4A261', label: 'IF' },
    // Switch
    switch: { svg: custom('<path d="M18 8L22 12L18 16"/><path d="M2 12H22"/><path d="M6 3L2 7L6 11"/><path d="M22 7H2"/>', '#8B5CF6'), color: '#8B5CF6', label: 'Switch' },
    // Merge
    merge: { svg: custom('<path d="M8 6L12 12L8 18"/><path d="M16 6L12 12L16 18"/>', '#06B6D4'), color: '#06B6D4', label: 'Merge' },
    // Split In Batches
    splitInBatches: { svg: custom('<rect x="3" y="3" width="18" height="6" rx="1"/><rect x="3" y="15" width="7" height="6" rx="1"/><rect x="14" y="15" width="7" height="6" rx="1"/>', '#0891B2'), color: '#0891B2', label: 'Split In Batches' },
    // Wait
    wait: { svg: custom('<circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>', '#F59E0B'), color: '#F59E0B', label: 'Wait' },
    // Schedule Trigger
    scheduleTrigger: { svg: custom('<circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/><path d="M5 3L2 6"/><path d="M19 3L22 6"/>', '#10B981'), color: '#10B981', label: 'Schedule Trigger' },
    // Manual Trigger
    manualTrigger: { svg: custom('<path d="M15 4V2a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v2"/><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="12" y1="10" x2="12" y2="16"/><line x1="9" y1="13" x2="15" y2="13"/>', '#6366F1'), color: '#6366F1', label: 'Manual Trigger' },
    // Webhook (trigger)
    webhookTrigger: { svg: custom('<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/><path d="M12 8v4l3 3"/>', '#6E42C1'), color: '#6E42C1', label: 'Webhook' },
    // HTTP Request
    httpRequest: { svg: custom('<circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>', '#6E42C1'), color: '#6E42C1', label: 'HTTP Request' },
    // Sticky Note
    stickyNote: { svg: custom('<path d="M15.5 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.5L15.5 3z"/><polyline points="14 3 14 9 21 9"/>', '#FBBF24'), color: '#FBBF24', label: 'Sticky Note' },
    // No Operation / Noop
    noOp: { svg: custom('<circle cx="12" cy="12" r="10"/><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/>', '#94A3B8'), color: '#94A3B8', label: 'No Operation' },
    // Function / Function Item
    function: { svg: custom('<polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>', '#607D8B'), color: '#607D8B', label: 'Function' },
    // Execute Command
    executeCommand: { svg: custom('<polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/>', '#475569'), color: '#475569', label: 'Execute Command' },
    // Read Binary File
    readBinaryFile: { svg: custom('<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/>', '#64748B'), color: '#64748B', label: 'Read Binary File' },
    // Write Binary File
    writeBinaryFile: { svg: custom('<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><polyline points="9 15 12 12 15 15"/>', '#64748B'), color: '#64748B', label: 'Write Binary File' },
    // Move Binary Data
    moveBinaryData: { svg: custom('<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><path d="M12 18v-6"/><path d="M9 15l3 3 3-3"/>', '#64748B'), color: '#64748B', label: 'Move Binary Data' },
    // Crypto
    crypto: { svg: custom('<rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/>', '#374151'), color: '#374151', label: 'Crypto' },
    // Date & Time
    dateTime: { svg: custom('<rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>', '#F472B6'), color: '#F472B6', label: 'Date & Time' },
    // Error Trigger
    errorTrigger: { svg: custom('<circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>', '#EF4444'), color: '#EF4444', label: 'Error Trigger' },
    // Start
    start: { svg: custom('<polygon points="5 3 19 12 5 21 5 3"/>', '#22C55E'), color: '#22C55E', label: 'Start' },
    // Stop and Error
    stopAndError: { svg: custom('<circle cx="12" cy="12" r="10"/><path d="M15 9l-6 6"/><path d="M9 9l6 6"/>', '#EF4444'), color: '#EF4444', label: 'Stop and Error' },
    // Respond to Webhook
    respondToWebhook: { svg: custom('<polyline points="9 10 4 15 9 20"/><path d="M20 4v7a4 4 0 0 1-4 4H4"/>', '#8B5CF6'), color: '#8B5CF6', label: 'Respond to Webhook' },
    // Execute Workflow
    executeWorkflow: { svg: custom('<polygon points="5 3 19 12 5 21 5 3"/><line x1="19" y1="3" x2="19" y2="21"/>', '#3B82F6'), color: '#3B82F6', label: 'Execute Workflow' },
    // Item Lists
    itemLists: { svg: custom('<line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/>', '#7C3AED'), color: '#7C3AED', label: 'Item Lists' },
    // HTML
    html: { svg: custom('<polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>', '#E34F26'), color: '#E34F26', label: 'HTML' },
    // XML
    xml: { svg: custom('<polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>', '#F57C00'), color: '#F57C00', label: 'XML' },
    // RSS Feed Read
    rssFeedRead: { svg: custom('<path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/>', '#F97316'), color: '#F97316', label: 'RSS Feed Read' },
    // Email / IMAP
    emailSend: { svg: custom('<path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/>', '#EA4335'), color: '#EA4335', label: 'Email' },
    // Spreadsheet File
    spreadsheetFile: { svg: custom('<rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="3" y1="15" x2="21" y2="15"/><line x1="9" y1="3" x2="9" y2="21"/><line x1="15" y1="3" x2="15" y2="21"/>', '#0F9D58'), color: '#0F9D58', label: 'Spreadsheet File' },
    // Compare Datasets
    compareDatasets: { svg: custom('<rect x="2" y="3" width="8" height="18" rx="1"/><rect x="14" y="3" width="8" height="18" rx="1"/><path d="M10 12h4"/>', '#6366F1'), color: '#6366F1', label: 'Compare Datasets' },
    // Form Trigger
    formTrigger: { svg: custom('<rect x="3" y="3" width="18" height="18" rx="2"/><line x1="7" y1="8" x2="17" y2="8"/><line x1="7" y1="12" x2="13" y2="12"/><rect x="7" y="15" width="4" height="2" rx="1"/>', '#FF6D5A'), color: '#FF6D5A', label: 'Form Trigger' },
    // Form (completion)
    form: { svg: custom('<rect x="3" y="3" width="18" height="18" rx="2"/><line x1="7" y1="8" x2="17" y2="8"/><line x1="7" y1="12" x2="13" y2="12"/><polyline points="9 16 11 18 15 14"/>', '#FF6D5A'), color: '#FF6D5A', label: 'Form' },
    // Split Out
    splitOut: { svg: custom('<line x1="4" y1="12" x2="10" y2="12"/><polyline points="14 6 20 6"/><polyline points="14 12 20 12"/><polyline points="14 18 20 18"/><polyline points="10 12 14 6"/><polyline points="10 12 14 18"/>', '#0891B2'), color: '#0891B2', label: 'Split Out' },
    // AI Agent
    agent: { svg: custom('<circle cx="12" cy="8" r="4"/><path d="M6 20v-2a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v2"/><circle cx="12" cy="8" r="1.5" fill="currentColor"/><path d="M8 4l-2-2"/><path d="M16 4l2-2"/>', '#8B5CF6'), color: '#8B5CF6', label: 'AI Agent' },
    // Chat Model (generic LM)
    lmChat: { svg: custom('<path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/><circle cx="8" cy="10" r="1"/><circle cx="12" cy="10" r="1"/><circle cx="16" cy="10" r="1"/>', '#6366F1'), color: '#6366F1', label: 'Chat Model' },
    // Tool (generic)
    tool: { svg: custom('<path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>', '#78716C'), color: '#78716C', label: 'Tool' },
    // Memory (buffer/window)
    memory: { svg: custom('<rect x="2" y="4" width="20" height="16" rx="2"/><path d="M6 2v4"/><path d="M18 2v4"/><path d="M2 10h20"/><path d="M7 14h2"/><path d="M11 14h6"/>', '#A855F7'), color: '#A855F7', label: 'Memory' },
    // Output Parser
    outputParser: { svg: custom('<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><path d="M9 15l2 2 4-4"/>', '#EC4899'), color: '#EC4899', label: 'Output Parser' },
    // Chain
    chain: { svg: custom('<path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>', '#F59E0B'), color: '#F59E0B', label: 'Chain' },
    // Text Classifier
    textClassifier: { svg: custom('<path d="M4 7V4h16v3"/><path d="M9 20h6"/><path d="M12 4v16"/>', '#3B82F6'), color: '#3B82F6', label: 'Text Classifier' },
    // Summarization
    summarizationChain: { svg: custom('<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="12" y2="17"/>', '#10B981'), color: '#10B981', label: 'Summarization' },
    // Vector Store
    vectorStore: { svg: custom('<ellipse cx="12" cy="6" rx="8" ry="3"/><path d="M4 6v6c0 1.657 3.582 3 8 3s8-1.343 8-3V6"/><path d="M4 12v6c0 1.657 3.582 3 8 3s8-1.343 8-3v-6"/>', '#06B6D4'), color: '#06B6D4', label: 'Vector Store' },
    // Embeddings
    embeddings: { svg: custom('<circle cx="6" cy="6" r="3"/><circle cx="18" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="18" r="3"/><line x1="6" y1="9" x2="6" y2="15"/><line x1="18" y1="9" x2="18" y2="15"/><line x1="9" y1="6" x2="15" y2="6"/><line x1="9" y1="18" x2="15" y2="18"/>', '#8B5CF6'), color: '#8B5CF6', label: 'Embeddings' },
    // Document Loader
    documentLoader: { svg: custom('<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><path d="M12 18v-6"/><path d="M9 15l3-3 3 3"/>', '#F97316'), color: '#F97316', label: 'Document Loader' },
    // Text Splitter
    textSplitter: { svg: custom('<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="4" y1="12" x2="20" y2="12"/>', '#64748B'), color: '#64748B', label: 'Text Splitter' },
    // Retriever
    retriever: { svg: custom('<circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/>', '#06B6D4'), color: '#06B6D4', label: 'Retriever' },
    // Information Extractor
    informationExtractor: { svg: custom('<circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><path d="M11 8v6"/><path d="M8 11h6"/>', '#3B82F6'), color: '#3B82F6', label: 'Information Extractor' },
    // Question and Answer
    questionAnswer: { svg: custom('<path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/>', '#6366F1'), color: '#6366F1', label: 'Q&A Chain' },
    // Sentiment Analysis
    sentimentAnalysis: { svg: custom('<circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/>', '#F59E0B'), color: '#F59E0B', label: 'Sentiment Analysis' },
  };

  /* ================================================================
   * 2.  NODE-TYPE → ICON KEY MAPPING
   * ================================================================ */

  // Map: n8n node type string → icon key
  // Convention: key is the part after the last '.' in lowercase,
  // but we also add some explicit overrides.
  var TYPE_MAP = {
    // --- Core / Built-in ---
    'n8n-nodes-base.code': 'code',
    'n8n-nodes-base.set': 'set',
    'n8n-nodes-base.editFields': 'editFields',
    'n8n-nodes-base.if': 'if',
    'n8n-nodes-base.switch': 'switch',
    'n8n-nodes-base.merge': 'merge',
    'n8n-nodes-base.splitInBatches': 'splitInBatches',
    'n8n-nodes-base.wait': 'wait',
    'n8n-nodes-base.scheduleTrigger': 'scheduleTrigger',
    'n8n-nodes-base.manualTrigger': 'manualTrigger',
    'n8n-nodes-base.webhook': 'webhookTrigger',
    'n8n-nodes-base.httpRequest': 'httpRequest',
    'n8n-nodes-base.stickyNote': 'stickyNote',
    'n8n-nodes-base.noOp': 'noOp',
    'n8n-nodes-base.function': 'function',
    'n8n-nodes-base.functionItem': 'function',
    'n8n-nodes-base.executeCommand': 'executeCommand',
    'n8n-nodes-base.readBinaryFile': 'readBinaryFile',
    'n8n-nodes-base.readBinaryFiles': 'readBinaryFile',
    'n8n-nodes-base.writeBinaryFile': 'writeBinaryFile',
    'n8n-nodes-base.moveBinaryData': 'moveBinaryData',
    'n8n-nodes-base.crypto': 'crypto',
    'n8n-nodes-base.dateTime': 'dateTime',
    'n8n-nodes-base.errorTrigger': 'errorTrigger',
    'n8n-nodes-base.start': 'start',
    'n8n-nodes-base.stopAndError': 'stopAndError',
    'n8n-nodes-base.respondToWebhook': 'respondToWebhook',
    'n8n-nodes-base.executeWorkflow': 'executeWorkflow',
    'n8n-nodes-base.executeWorkflowTrigger': 'executeWorkflow',
    'n8n-nodes-base.itemLists': 'itemLists',
    'n8n-nodes-base.html': 'html',
    'n8n-nodes-base.xml': 'xml',
    'n8n-nodes-base.rssFeedRead': 'rssFeedRead',
    'n8n-nodes-base.emailSend': 'emailSend',
    'n8n-nodes-base.emailReadImap': 'emailSend',
    'n8n-nodes-base.spreadsheetFile': 'spreadsheetFile',
    'n8n-nodes-base.compareDatasets': 'compareDatasets',
    'n8n-nodes-base.n8n': 'n8n',

    // --- Platforms / Brands ---
    'n8n-nodes-base.openAi': 'openai',
    '@n8n/n8n-nodes-langchain.openAi': 'openai',
    '@n8n/n8n-nodes-langchain.lmChatOpenAi': 'openai',
    '@n8n/n8n-nodes-langchain.lmOpenAi': 'openai',
    'n8n-nodes-base.discord': 'discord',
    'n8n-nodes-base.discordTrigger': 'discord',
    'n8n-nodes-base.slack': 'slack',
    'n8n-nodes-base.slackTrigger': 'slack',
    'n8n-nodes-base.telegram': 'telegram',
    'n8n-nodes-base.telegramTrigger': 'telegram',
    'n8n-nodes-base.github': 'github',
    'n8n-nodes-base.githubTrigger': 'github',
    'n8n-nodes-base.googleSheets': 'googleSheets',
    'n8n-nodes-base.googleSheetsTrigger': 'googleSheets',
    'n8n-nodes-base.googleDrive': 'googleDrive',
    'n8n-nodes-base.googleDriveTrigger': 'googleDrive',
    'n8n-nodes-base.googleCalendar': 'googleCalendar',
    'n8n-nodes-base.googleCalendarTrigger': 'googleCalendar',
    'n8n-nodes-base.gmail': 'gmail',
    'n8n-nodes-base.gmailTrigger': 'gmail',
    'n8n-nodes-base.notion': 'notion',
    'n8n-nodes-base.notionTrigger': 'notion',
    'n8n-nodes-base.airtable': 'airtable',
    'n8n-nodes-base.airtableTrigger': 'airtable',
    'n8n-nodes-base.stripe': 'stripe',
    'n8n-nodes-base.stripeTrigger': 'stripe',
    'n8n-nodes-base.twilio': 'twilio',
    'n8n-nodes-base.shopify': 'shopify',
    'n8n-nodes-base.shopifyTrigger': 'shopify',
    'n8n-nodes-base.wordpress': 'wordpress',
    'n8n-nodes-base.jira': 'jira',
    'n8n-nodes-base.jiraTrigger': 'jira',
    'n8n-nodes-base.trello': 'trello',
    'n8n-nodes-base.trelloTrigger': 'trello',
    'n8n-nodes-base.asana': 'asana',
    'n8n-nodes-base.asanaTrigger': 'asana',
    'n8n-nodes-base.dropbox': 'dropbox',
    'n8n-nodes-base.microsoftExcel': 'excel',
    'n8n-nodes-base.microsoftOutlook': 'outlook',
    'n8n-nodes-base.microsoftOneDrive': 'microsoft',
    'n8n-nodes-base.microsoftTeams': 'microsoft',
    'n8n-nodes-base.microsoftToDo': 'microsoft',
    'n8n-nodes-base.awsS3': 'aws',
    'n8n-nodes-base.awsSes': 'aws',
    'n8n-nodes-base.awsSns': 'aws',
    'n8n-nodes-base.awsLambda': 'aws',
    'n8n-nodes-base.awsDynamoDb': 'aws',
    'n8n-nodes-base.supabase': 'supabase',
    'n8n-nodes-base.firebase': 'firebase',
    'n8n-nodes-base.mongoDb': 'mongodb',
    'n8n-nodes-base.mySql': 'mysql',
    'n8n-nodes-base.postgres': 'postgresql',
    'n8n-nodes-base.redis': 'redis',
    'n8n-nodes-base.salesforce': 'salesforce',
    'n8n-nodes-base.hubspot': 'hubspot',
    'n8n-nodes-base.hubspotTrigger': 'hubspot',
    'n8n-nodes-base.mailchimp': 'mailchimp',
    'n8n-nodes-base.mailchimpTrigger': 'mailchimp',
    'n8n-nodes-base.sendGrid': 'sendgrid',
    'n8n-nodes-base.zendesk': 'zendesk',
    'n8n-nodes-base.zendeskTrigger': 'zendesk',
    'n8n-nodes-base.intercom': 'intercom',
    'n8n-nodes-base.webflow': 'webflow',
    'n8n-nodes-base.webflowTrigger': 'webflow',
    'n8n-nodes-base.figma': 'figma',
    'n8n-nodes-base.twitter': 'x',
    'n8n-nodes-base.facebookGraphApi': 'facebook',
    'n8n-nodes-base.linkedIn': 'linkedin',
    'n8n-nodes-base.youTube': 'youtube',
    'n8n-nodes-base.whatsApp': 'whatsapp',
    'n8n-nodes-base.zoom': 'zoom',
    'n8n-nodes-base.spotify': 'spotify',
    'n8n-nodes-base.zapier': 'zapier',
    '@n8n/n8n-nodes-langchain.lmChatAnthropic': 'anthropic',
    '@n8n/n8n-nodes-langchain.lmAnthropic': 'anthropic',

    // --- Forms ---
    'n8n-nodes-base.formTrigger': 'formTrigger',
    'n8n-nodes-base.form': 'form',

    // --- Split / Transform ---
    'n8n-nodes-base.splitOut': 'splitOut',
    'n8n-nodes-base.removeDuplicates': 'itemLists',
    'n8n-nodes-base.sort': 'itemLists',
    'n8n-nodes-base.limit': 'itemLists',
    'n8n-nodes-base.aggregate': 'itemLists',
    'n8n-nodes-base.summarize': 'itemLists',
    'n8n-nodes-base.filter': 'if',

    // --- LangChain: Agents ---
    '@n8n/n8n-nodes-langchain.agent': 'agent',
    '@n8n/n8n-nodes-langchain.chainRetrievalQa': 'questionAnswer',
    '@n8n/n8n-nodes-langchain.chainSummarization': 'summarizationChain',
    '@n8n/n8n-nodes-langchain.chainLlm': 'chain',
    '@n8n/n8n-nodes-langchain.chain': 'chain',
    '@n8n/n8n-nodes-langchain.textClassifier': 'textClassifier',
    '@n8n/n8n-nodes-langchain.sentimentAnalysis': 'sentimentAnalysis',
    '@n8n/n8n-nodes-langchain.informationExtractor': 'informationExtractor',

    // --- LangChain: Chat Models ---
    '@n8n/n8n-nodes-langchain.lmChatOpenRouter': 'openrouter',
    '@n8n/n8n-nodes-langchain.lmChatOllama': 'lmChat',
    '@n8n/n8n-nodes-langchain.lmChatGroq': 'lmChat',
    '@n8n/n8n-nodes-langchain.lmChatMistralCloud': 'lmChat',
    '@n8n/n8n-nodes-langchain.lmChatGoogleVertex': 'google',
    '@n8n/n8n-nodes-langchain.lmChatGoogleGemini': 'google',
    '@n8n/n8n-nodes-langchain.lmChatAzureOpenAi': 'microsoft',
    '@n8n/n8n-nodes-langchain.lmChatHuggingFace': 'lmChat',
    '@n8n/n8n-nodes-langchain.lmChatAwsBedrock': 'aws',
    '@n8n/n8n-nodes-langchain.lmCohere': 'lmChat',

    // --- LangChain: Tools ---
    '@n8n/n8n-nodes-langchain.toolWikipedia': 'wikipedia',
    '@n8n/n8n-nodes-langchain.toolCalculator': 'tool',
    '@n8n/n8n-nodes-langchain.toolCode': 'code',
    '@n8n/n8n-nodes-langchain.toolHttpRequest': 'httpRequest',
    '@n8n/n8n-nodes-langchain.toolSerpApi': 'tool',
    '@n8n/n8n-nodes-langchain.toolWolframAlpha': 'tool',
    '@n8n/n8n-nodes-langchain.toolWorkflow': 'executeWorkflow',
    '@n8n/n8n-nodes-langchain.toolVectorStore': 'vectorStore',

    // --- LangChain: Memory ---
    '@n8n/n8n-nodes-langchain.memoryBufferWindow': 'memory',
    '@n8n/n8n-nodes-langchain.memoryMotorhead': 'memory',
    '@n8n/n8n-nodes-langchain.memoryRedis': 'redis',
    '@n8n/n8n-nodes-langchain.memoryPostgresChat': 'postgresql',
    '@n8n/n8n-nodes-langchain.memoryXata': 'memory',
    '@n8n/n8n-nodes-langchain.memoryZep': 'memory',

    // --- LangChain: Output Parsers ---
    '@n8n/n8n-nodes-langchain.outputParserStructured': 'outputParser',
    '@n8n/n8n-nodes-langchain.outputParserAutofixing': 'outputParser',
    '@n8n/n8n-nodes-langchain.outputParserItemList': 'outputParser',

    // --- LangChain: Vector Stores ---
    '@n8n/n8n-nodes-langchain.vectorStoreInMemory': 'vectorStore',
    '@n8n/n8n-nodes-langchain.vectorStorePinecone': 'vectorStore',
    '@n8n/n8n-nodes-langchain.vectorStoreQdrant': 'vectorStore',
    '@n8n/n8n-nodes-langchain.vectorStoreSupabase': 'supabase',
    '@n8n/n8n-nodes-langchain.vectorStoreZep': 'vectorStore',
    '@n8n/n8n-nodes-langchain.vectorStorePgVector': 'postgresql',

    // --- LangChain: Embeddings ---
    '@n8n/n8n-nodes-langchain.embeddingsOpenAi': 'openai',
    '@n8n/n8n-nodes-langchain.embeddingsAzureOpenAi': 'microsoft',
    '@n8n/n8n-nodes-langchain.embeddingsCohere': 'embeddings',
    '@n8n/n8n-nodes-langchain.embeddingsHuggingFaceInference': 'embeddings',
    '@n8n/n8n-nodes-langchain.embeddingsGoogleVertex': 'google',
    '@n8n/n8n-nodes-langchain.embeddingsGoogleGemini': 'google',
    '@n8n/n8n-nodes-langchain.embeddingsOllama': 'embeddings',
    '@n8n/n8n-nodes-langchain.embeddingsMistralCloud': 'embeddings',

    // --- LangChain: Document Loaders ---
    '@n8n/n8n-nodes-langchain.documentDefaultDataLoader': 'documentLoader',
    '@n8n/n8n-nodes-langchain.documentGithubLoader': 'github',
    '@n8n/n8n-nodes-langchain.documentJsonLoader': 'documentLoader',
    '@n8n/n8n-nodes-langchain.documentBinaryInputLoader': 'documentLoader',

    // --- LangChain: Text Splitters ---
    '@n8n/n8n-nodes-langchain.textSplitterCharacter': 'textSplitter',
    '@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacter': 'textSplitter',
    '@n8n/n8n-nodes-langchain.textSplitterTokenSplitter': 'textSplitter',

    // --- LangChain: Retrievers ---
    '@n8n/n8n-nodes-langchain.retrieverContextualCompression': 'retriever',
    '@n8n/n8n-nodes-langchain.retrieverMultiQuery': 'retriever',
    '@n8n/n8n-nodes-langchain.retrieverVectorStore': 'retriever',
    '@n8n/n8n-nodes-langchain.retrieverWorkflow': 'retriever',

    // --- Extra platforms ---
    'n8n-nodes-base.pipedrive': 'pipedrive',
    'n8n-nodes-base.pipedriveTrigger': 'pipedrive',
    'n8n-nodes-base.typeform': 'typeform',
    'n8n-nodes-base.typeformTrigger': 'typeform',
    'n8n-nodes-base.mattermost': 'mattermost',
  };

  /* ================================================================
   * 3.  ICON LOOKUP & NODE EXTRACTION
   * ================================================================ */

  // Default (unknown) icon – generates a letter-based circle icon dynamically
  var DEFAULT_ICON_FALLBACK = {
    svg: custom('<circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/>', '#94A3B8'),
    color: '#94A3B8',
    label: 'Unknown'
  };

  /**
   * Create a default icon showing the first letter of a label in a circle.
   */
  function makeDefaultIcon(label) {
    var displayLabel = label || 'Unknown';
    var letter = displayLabel.charAt(0).toUpperCase();
    var color = '#94A3B8';
    var svg = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">' +
      '<circle cx="12" cy="12" r="11" fill="' + color + '" opacity="0.15"/>' +
      '<circle cx="12" cy="12" r="11" fill="none" stroke="' + color + '" stroke-width="1.5"/>' +
      '<text x="12" y="16.5" text-anchor="middle" fill="' + color + '" font-size="13" font-weight="600" font-family="system-ui,sans-serif">' + letter + '</text>' +
      '</svg>';
    return { svg: svg, color: color, label: displayLabel };
  }

  /**
   * Resolve an icon key to { svg, color, label }.
   */
  function resolveIcon(key) {
    // Check internal first
    if (N8N_INTERNAL[key]) {
      return N8N_INTERNAL[key];
    }
    // Check brands
    if (BRANDS[key]) {
      var b = BRANDS[key];
      return {
        svg: si(b.path, b.color),
        color: b.color,
        label: key.charAt(0).toUpperCase() + key.slice(1)
      };
    }
    return null;
  }

  /**
   * Guess icon key from n8n node type string via heuristic.
   * e.g. 'n8n-nodes-base.readBinaryFile' → try 'readBinaryFile', then 'readbinaryfile'
   * Also handles @n8n/n8n-nodes-langchain.* patterns by detecting category prefixes.
   */
  function guessKeyFromType(nodeType) {
    if (!nodeType) return null;
    var parts = nodeType.split('.');
    var raw = parts[parts.length - 1]; // e.g. 'openAi', 'googleSheets', 'lmChatOpenRouter'

    // Direct match in brands or internal
    if (N8N_INTERNAL[raw]) return raw;
    if (BRANDS[raw]) return raw;

    // Lowercase match
    var lower = raw.toLowerCase();
    var allKeys = Object.keys(BRANDS).concat(Object.keys(N8N_INTERNAL));
    for (var i = 0; i < allKeys.length; i++) {
      if (allKeys[i].toLowerCase() === lower) return allKeys[i];
    }

    // Partial match: remove "Trigger" suffix
    var withoutTrigger = raw.replace(/Trigger$/i, '');
    if (N8N_INTERNAL[withoutTrigger]) return withoutTrigger;
    if (BRANDS[withoutTrigger]) return withoutTrigger;
    var withoutTriggerLower = withoutTrigger.toLowerCase();
    for (var j = 0; j < allKeys.length; j++) {
      if (allKeys[j].toLowerCase() === withoutTriggerLower) return allKeys[j];
    }

    // LangChain prefix heuristics (lmChat*, tool*, memory*, embeddings*, vectorStore*, etc.)
    var langchainPrefixes = [
      { prefix: 'lmChat', key: 'lmChat' },
      { prefix: 'lm', key: 'lmChat' },
      { prefix: 'tool', key: 'tool' },
      { prefix: 'memory', key: 'memory' },
      { prefix: 'embeddings', key: 'embeddings' },
      { prefix: 'vectorStore', key: 'vectorStore' },
      { prefix: 'outputParser', key: 'outputParser' },
      { prefix: 'textSplitter', key: 'textSplitter' },
      { prefix: 'retriever', key: 'retriever' },
      { prefix: 'document', key: 'documentLoader' },
      { prefix: 'chain', key: 'chain' },
      { prefix: 'agent', key: 'agent' },
    ];
    for (var k = 0; k < langchainPrefixes.length; k++) {
      var p = langchainPrefixes[k];
      if (raw.indexOf(p.prefix) === 0 || lower.indexOf(p.prefix.toLowerCase()) === 0) {
        return p.key;
      }
    }

    return null;
  }

  /**
   * Get icon data for a given n8n node type.
   * @param {string} nodeType - e.g. 'n8n-nodes-base.openAi'
   * @returns {{ svg: string, color: string, label: string }}
   */
  function getNodeIcon(nodeType) {
    if (!nodeType) return makeDefaultIcon('Unknown');

    // 1. Exact match in TYPE_MAP
    var key = TYPE_MAP[nodeType];
    if (key) {
      var icon = resolveIcon(key);
      if (icon) return icon;
    }

    // 2. Heuristic guess
    var guessed = guessKeyFromType(nodeType);
    if (guessed) {
      var icon2 = resolveIcon(guessed);
      if (icon2) return icon2;
    }

    // 3. Generate a letter-based default icon with the node name as label
    var fallbackLabel = nodeType.split('.').pop() || 'Unknown';
    // Convert camelCase to readable: 'formTrigger' → 'Form Trigger'
    var readable = fallbackLabel.replace(/([A-Z])/g, ' $1').replace(/^./, function(s){ return s.toUpperCase(); }).trim();
    return makeDefaultIcon(readable);
  }

  /**
   * Extract unique nodes from a workflow JSON object.
   * @param {object} jsonData - The n8n workflow JSON
   * @returns {Array<{ type: string, label: string, icon: { svg: string, color: string, label: string } }>}
   */
  function extractNodes(jsonData) {
    var workflow = jsonData;

    // Handle nested workflow structure
    if (workflow && workflow.workflow && typeof workflow.workflow === 'object') {
      workflow = workflow.workflow;
    }

    if (!workflow || !Array.isArray(workflow.nodes)) {
      return [];
    }

    var seen = {};
    var result = [];

    for (var i = 0; i < workflow.nodes.length; i++) {
      var node = workflow.nodes[i];
      if (!node || !node.type) continue;

      // Skip sticky notes from the badge list
      if (node.type === 'n8n-nodes-base.stickyNote') continue;

      var type = node.type;
      if (seen[type]) continue;
      seen[type] = true;

      var icon = getNodeIcon(type);
      result.push({
        type: type,
        label: node.typeVersion ? icon.label : icon.label,
        icon: icon,
      });
    }

    return result;
  }

  /**
   * Generate HTML for node icon badges.
   * @param {object} jsonData - The n8n workflow JSON
   * @param {object} [options] - { max: number, size: number }
   * @returns {string} HTML string
   */
  function renderBadges(jsonData, options) {
    var opts = options || {};
    var max = opts.max || 6;
    var size = opts.size || 20;

    var nodes = extractNodes(jsonData);
    if (!nodes.length) return '';

    var visible = nodes.slice(0, max);
    var extra = nodes.length - max;

    var html = '<span class="n8n-wf-node-badges">';
    for (var i = 0; i < visible.length; i++) {
      var n = visible[i];
      html += '<span class="n8n-wf-node-badge" title="' + escapeAttr(n.label) + '" style="width:' + size + 'px;height:' + size + 'px">' + n.icon.svg + '</span>';
    }
    if (extra > 0) {
      html += '<span class="n8n-wf-node-badge n8n-wf-node-badge--more" title="' + extra + ' more nodes">+' + extra + '</span>';
    }
    html += '</span>';

    return html;
  }

  function escapeAttr(str) {
    return String(str || '')
      .replace(/&/g, '&amp;')
      .replace(/"/g, '&quot;')
      .replace(/'/g, '&#39;')
      .replace(/</g, '&lt;')
      .replace(/>/g, '&gt;');
  }

  /* ================================================================
   * 4.  PUBLIC API
   * ================================================================ */

  return {
    getNodeIcon: getNodeIcon,
    extractNodes: extractNodes,
    renderBadges: renderBadges,
    VERSION: '1.0.0',
  };
});
